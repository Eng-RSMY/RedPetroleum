@model List<RedPetroleum.Models.ReportByCompanyViewModel>
@{
    int i = 1;
}
@if (Model != null)
{
    foreach (var employee in Model)
    {
        <tr>
            <td class="text-center">@(i++)</td>
            <td>@employee.EmployeeName</td>
            <td>@employee.Department</td>
            <td>@employee.Position</td>
            <td class="text-center">@employee.AdoptionDate</td>
            <td class="text-center">@Math.Round(Convert.ToDouble(employee.AverageMark), 2) %</td>
            @if(employee.VisitationMark!= null)
            {
                <td class="text-center">@employee.VisitationMark %</td>
            }
            else
            {
                <td class="text-center">0 %</td>
            }
            <td class="text-center">@Math.Round(Convert.ToDouble(employee.StepMark), 2) %</td>
        </tr>
    }
    if(!Double.IsNaN(ViewBag.AverageByCompany))
    { 
        <tr>
            <th colspan="4">
                Средний показатель по отделу:
            </th>
            <td></td>
            <td class="text-center">@ViewBag.AverageByCompany %</td>
            <td></td>
            <td></td>
        </tr>
    }
}